NewYork_Missions_1 = { # Expansion / Military (Wayne)
	slot = 1
	generic = no
	ai = yes
	potential = {
		tag = NYS
	}
	has_country_shield = yes

	nys_secure_military_funding = {
		position = 3
		icon = mission_assemble_an_army
		required_missions = {
			nys_city_reunited
		}
		trigger = {
			army_size_percentage = 0.9
		}
		effect = {
			add_country_modifier = {
				name = nys_military_funding_secured
				duration = 5475 
			}
		}
	}
	nys_the_reservists = {
		icon = mission_assemble_an_army
		required_missions = {
			nys_secure_military_funding
		}
		trigger = {
			manpower_percentage = 0.75
			faction_in_power = mr_aristocrats
		}
		effect = {
			965 = {
				add_base_manpower = 2
				add_province_modifier = {
					name = nys_reservist_base
					duration = -1
				}
			}
		}
	}
	nys_house_the_troops = {
		icon = mission_assemble_an_army
		required_missions = {
			nys_the_reservists
		}
		trigger = {
			barracks = 3
			faction_influence = {
				faction = mr_aristocrats
				influence = 70
			}
		}
		effect = {
			add_country_modifier = {
				name = nys_efficient_quartering_of_troops
				duration = 10950
			}
		}
	}
	nys_formalise_the_militia = {
		icon = mission_assemble_an_army
		required_missions = {
			nys_house_the_troops
		}
		provinces_to_highlight = {
			province_id = 965
		}
		trigger = {
			treasury = 100
			965 = {
				infantry_in_province = 10
			}
		}
		effect = {
			custom_tooltip = NYS_MILITIA
			set_country_flag = nys_mercs_unlocked
			add_treasury = -100
			965 = {
				kill_units = {
					who = owner
					type = infantry
					amount = 10
				}
			}
		}
	}
}
	# WAYNE
nys_wayne_tree = {
	slot = 1
	potential = {
		tag = NYS
		has_country_flag = nys_familial_missions
	}
	has_country_shield = yes

	nys_looking_westwards = {
		position = 8
		icon = mission_alliances
		required_missions = {
			nys_tammany_republic
		}
		trigger = {
			OR = {
				AND = {
					treasury = 100
					has_spy_network_in = {
						who = COA
						value = 80
					}
					is_rival = COA
				}
				NOT = {
					exists = COA
				}
			}
		}
		effect = {
			4582 = {
				add_permanent_claim = NYS
			}
			2023 = {
				add_permanent_claim = NYS
			}
			4621 = {
				add_permanent_claim = NYS
			}
			if = {
				limit = { 
					exists = COA
				}
				COA = {
					add_opinion = {
						who = NYS
						modifier = nys_laid_claims
					}
				}
			}
			add_treasury = -100
		}
	}
	nys_redcoat_lessons = {
		icon = mission_assemble_an_army
		required_missions = {
			nys_looking_westwards
		}
		provinces_to_highlight = {
			province_id = 968
		}
		trigger = {
			dip_power = 75
			RED = {
				has_opinion = {
					who = NYS
					value = 150
				}
			}
		}
		effect = {
			define_advisor = {
				type = army_reformer
				skill = 2
				discount = yes
				culture = british
				religion = glorian
			}
			add_country_modifier = {
				name = nys_redcoat_military_advice
				duration = 10950
			}
		}
	}
	nys_well_oiled_militia = {
		icon = mission_assemble_an_army
		required_missions = {
			nys_redcoat_lessons
		}
		trigger = {
			army_professionalism = 0.5
		}
		effect = {
			add_country_modifier = {
				name = nys_military_furor
				duration = 7300
			}
		}
	}
	nys_growing_tensions = {
		icon = mission_assemble_an_army
		required_missions = {
			nys_well_oiled_militia
		}
		provinces_to_highlight = {
			province_id = 968
			province_id = 4583
		}
		trigger = {
			HUD = {
				is_rival = NYS
			}
			has_spy_network_in = {
				who = HUD
				value = 80
			}
			alliance_with = RED
		}
		effect = {
			country_event = {
				id = ny_events.3
			}
		}
	}
	nys_anabaptist_heresy = { # FOR LOC: This is House Wayne's initiative. It shouldn't really clash too much with the religious branch (House Levi)
		icon = mission_assemble_an_army
		required_missions = {
			nys_growing_tensions
		}
		provinces_to_highlight = {
			area = hudson_valley_area
		}
		trigger = {
			hudson_valley_area = {
				type = all
				owned_by = NYS
			}
			NYS = {
				NOT = {
					religion = anabaptist
				}
			}
		}
		effect = {
			country_event = {
				id = ny_events.4
			}
		}
	}
}
NewYork_Missions_2 = { # Development / City Economics (Coeur)
	slot = 2
	generic = no
	ai = yes
	potential = {
		tag = NYS
	}
	has_country_shield = yes

	nys_the_city_never_sleeps = {
		position = 3
		icon = mission_assemble_an_army
		required_missions = {
			nys_city_reunited
		}
		provinces_to_highlight = {
			province_id = 965
		}
		trigger = {
			965 = {
				development = 30
			}
		}
		effect = {
			gotham_area = {
				add_province_modifier = {
					name = nys_gotham_revitalized
					duration = 9125
				}
			}
		}
	}
	nys_hire_economists = {
		icon = mission_assemble_an_army
		required_missions = {
			nys_the_city_never_sleeps
		}
		trigger = {
			OR = {
				advisor = treasurer
				advisor = master_of_mint
			}
			
		}
		effect = {
			add_country_modifier = {
				name = nys_streamlined_budget
				duration = 10950
			}
		}
	}
	nys_new_guild_privileges = {
		icon = mission_assemble_an_army
		required_missions = {
			nys_hire_economists
		}
		provinces_to_highlight = {
			area = gotham_area
		}
		trigger = {
			gotham_area = {
				type = all
				has_building = workshop
			}
			faction_influence = {
				faction = mr_guilds
				influence = 70
			}
		}
		effect = {
			add_country_modifier = {
				name = nys_new_guild_privileges
				duration = 3650
			}
		}
	}
	nys_infrastructure_plan = {
		icon = mission_assemble_an_army
		required_missions = {
			nys_new_guild_privileges
		}
		trigger = {
			manpower = 20
			treasury = 150
			NOT = {
				inflation = 0.5
			}
		}
		effect = {
			add_manpower = -15
			add_treasury = -150
			add_country_modifier = {
				name = nys_infrastructure_plan
				duration = 18250
			}
		}
	}
}
	# COEUR
nys_coeur_tree = {
	slot = 2
	potential = {
		tag = NYS
		has_country_flag = nys_familial_missions
	}
	has_country_shield = yes

	nys_manhattan_land_efficiency_act = {
		position = 8
		icon = mission_assemble_an_army
		required_missions = {
			nys_tammany_republic
		}
		provinces_to_highlight = {
			province_id = 965
		}
		trigger = {
			965 = {
				grown_by_development = 20
			}
		}
		effect = {
			965 = {
				add_province_modifier = {
					name = nys_manhattan_project
					duration = -1
				}
			}
		}
	}
	nys_superway_plan = {
		icon = mission_assemble_an_army
		required_missions = {
			nys_manhattan_land_efficiency_act
		}
		provinces_to_highlight = {
			area = gotham_area
		}
		trigger = {
			gotham_area = {
				type = all
				development = 20
			}
			treasury = 500
		}
		effect = {
			add_treasury = -500
			gotham_area = {
				add_province_modifier = {
					name = nys_superway_construction
					duration = 7300
				}
			}
		}
	}
	nys_complete_the_superway = {
		icon = mission_assemble_an_army
		required_missions = {
			nys_superway_plan
		}
		provinces_to_highlight = {
			area = gotham_area
		}
		trigger = {
			treasury = 500
			gotham_area = {
				type = all
				NOT = {
					has_province_modifier = nys_superway_construction
				}
			}
		}
		effect = {
			add_treasury = -500
			gotham_area = {
				add_province_modifier = {
					name = nys_superway
					duration = -1
				}
			}
		}
	}
	nys_libertys_city = {
		icon = mission_assemble_an_army
		required_missions = {
			nys_complete_the_superway
		}
		provinces_to_highlight = {
			province_id = 965
		}
		trigger = {
			965 = {
				has_great_project = {
					type = lady_liberty
					tier = 3
				}
			}
		}
		effect = {
			country_event = {
				id = ny_events.5
			}
		}
	}
}

NewYork_Missions_3 = { # Tammany
	slot = 3
	generic = no
	ai = yes
	potential = {
		tag = NYS
	}
	has_country_shield = yes

	nys_stake_our_claim = {
		position = 1
		icon = mission_alliances
		required_missions = {}
		trigger = {
			treasury = 50
		}
		effect = {
			add_treasury = -50
			962 = {
				add_permanent_claim = NYS
			}
		}
	}
	nys_city_reunited = {
		icon = mission_assemble_an_army
		required_missions = {
			nys_stake_our_claim
		}
		provinces_to_highlight = {
			province_id = 962
		}
		trigger = {
			962 = {
				owned_by = NYS
			}
		}
		effect = {
			962 = {
				add_core = NYS
			}
		}
	}
	nys_tammany_republic = {
		position = 7
		icon = mission_assemble_an_army
		required_missions = {
			nys_city_reunited
			nys_formalise_the_militia
			nys_infrastructure_plan
			nys_overseas_investments
			nys_common_understanding
		}
		trigger = {
			NOT = {
				has_ruler =  "Gareth II"
			}
			stability = 2
			adm_power = 150
			dip_power = 150
			mil_power = 150
		}
		effect = {
			add_adm_power = -150
			add_dip_power = -150
			add_mil_power = -150
			country_event = {
				id = ny_events.6
			}
		}
	}
}

nys_cloak_dagger_tree = {
	slot = 3
	potential = {
		has_country_flag = nys_familial_missions
	}
	has_country_shield = yes

	nys_family_act = { # Enact special tier 2 "Republican Virtues" reform which strengthens the guilds and adds yearly corruption
		icon = mission_alliances
		required_missions = {
			nys_tammany_republic
		}
		trigger = {
			OR = {
				has_reform = tammany_republic_reform
				has_reform = vicar_of_lady_liberty_reform
			}
			republican_tradition = 90
			government_reform_progress = 100
		}
		effect = {
			country_event = {
				id = ny_events.9
			}
		}
	}

	nys_league_intimidation = { # Expand the trade league through intrigue and bribery
		icon = mission_alliances
		required_missions = {
			nys_family_act
		}
		trigger = {
			treasury = 150
			OR = {
				AND = {
					exists = PLD
					has_spy_network_in = {
						who = PLD
						value = 50
					}
					PLD = {
						has_opinion = {
							who = ROOT
							value = 150
						}
					}
				}
				NOT = { exists = PLD }
			}
		}
		effect = {
			add_corruption = 2
			add_treasury = -150
			PLD = {
				country_event = {
					id = ny_events.7
				}
			}
		}
	}

	nys_smugglers_paradise = { # Gain a local modifier somewhere which gives unrest in exchange for local trade power. Maybe gives negative diplo rep too?
		icon = mission_alliances
		required_missions = {
			nys_league_intimidation
		}
		trigger = {
			OR = {
				spymaster = 1
				trader = 1
				naval_reformer = 1
			}
			has_privateers = yes
			4539 = {
				has_building = marketplace
			}
		}
		effect = {
			4539 = {
				light_ship = NYS
				light_ship = NYS
				light_ship = NYS
				light_ship = NYS
				light_ship = NYS
				add_province_modifier = {
					name = nys_smugglers_paradise
					duration = -1
				}
			}
		}
	}

	nys_no_special_favors = {
		icon = mission_alliances
		required_missions = {
			nys_smugglers_paradise
		}
		trigger = {
			has_spy_network_in = {
				who = RED
				value = 100
			}
			num_of_heavy_ship = 10 # Don't let any survivors escape back to the "Old" World
			navy_size_percentage = 1
		}
		effect = {
			massachusetts_bay_area = {
				add_permanent_claim = NYS
			}
			connecticut_valley_area = {
				add_permanent_claim = NYS
			}
			# Add some sort of negative "Infiltration from unknown spies" modifier to RED here
			RED = {
				add_country_modifier = {
					name = nys_unknown_infiltration
					duration = 7300
				}
			}
		}
	}

	nys_heart_of_darkness = { # Culmination of our many exploits in the criminal underworld
		icon = mission_alliances
		required_missions = {
			nys_no_special_favors
		}
		trigger = {
			spy_ideas = 7
			massachusetts_bay_area = {
				owned_by = NYS
				type = all
			}
			connecticut_valley_area = {
				owned_by = NYS
				type = all
			}
		}
		effect = {
			add_country_modifier = {
				name = nys_heart_of_darkness
				duration = -1
			}
		}
	}
}

NewYork_Missions_4 = { # Trade / Colonialism (Amos)
	slot = 4
	generic = no
	ai = yes
	potential = {
		tag = NYS
	}
	has_country_shield = yes

	nys_establish_the_coastguard = {
		icon = mission_alliances
		required_missions = {
			nys_city_reunited
		}
		position = 3
		trigger = {
			num_of_galley = 10
		}
		effect = {
			add_country_modifier = {
				name = nys_coastguard_established
				duration = 7300
			}
		}
	}

	nys_strengthen_the_league = {
		icon = mission_alliances
		required_missions = {
			nys_establish_the_coastguard
		}
		trigger = {
			is_trade_league_leader = yes
			calc_true_if = {
				all_known_country = {
					is_in_trade_league_with = ROOT
				}
				amount = 4
			}
		}
		effect = {
			add_dip_power = 150
			every_known_country = {
				if = {
					limit = { 
						is_in_trade_league_with = NYS
					}
					add_opinion = {
						who = NYS
						modifier = nys_league_diplomacy
					}
				}
			}
		}
	}

	nys_trade_commitments = {
		icon = mission_alliances
		required_missions = {
			nys_strengthen_the_league
		}
		trigger = {
			advisor = trader
			1500 = {
				is_strongest_trade_power = ROOT
			}
			trade_income_percentage = 0.6
		}
		effect = {
			add_country_modifier = {
				name = nys_future_of_trade
				duration = -1
			}
		}
	}

	nys_overseas_investments = {
		icon = mission_alliances
		required_missions = {
			nys_trade_commitments
		}
		trigger = {
			has_spy_network_in = {
				who = BRM
				value = 50
			}
			num_of_transport = 10
		}
		effect = {
			481 = {
				add_permanent_claim = NYS
			}
			add_country_modifier = {
				name = nys_amphibious_warfare
				duration = 3650
			}
		}
	}
}

nys_amos_tree = {
	slot = 4
	potential = {
		tag = NYS
		has_country_flag = nys_familial_missions
	}
	has_country_shield = yes

	nys_maritime_secrets = { # Infiltrate MRT for their colonial secrets, apply them to our own position in Bermuda
		icon = mission_alliances
		required_missions = {
			nys_tammany_republic
		}
		position = 8
		trigger = {
			has_spy_network_in = {
				who = MRT
				value = 50
			}
		}
		effect = {
			add_country_modifier = {
				name = nys_colonial_secrets
				duration = 5475
			}
			MRT = {
				add_opinion = {
					who = NYS
					modifier = nys_colonial_rivalry
				}
			}
		}
	}
	
	nys_branching_out = { # Have discovered Africa / Europe. 
		icon = mission_alliances
		required_missions = {
			nys_maritime_secrets
		}
		trigger = {
			OR = {
				1276 = {
					has_discovered = ROOT
				}
				1293 = {
					has_discovered = ROOT
				}
				1269 = {
					has_discovered = ROOT
				}
			}
		}
		effect = {
			country_event = {
				id = ny_events.10
			}
		}
	}

	nys_staging_ground = {
		icon = mission_alliances
		required_missions = {
			nys_branching_out
		}
		trigger = {
			481 = {
				owned_by = NYS
				has_building = dock
			}
			has_idea = quest_for_the_new_world
		}
		effect = {
			481 = {
				add_province_modifier = {
					name = nys_staging_ground
					duration = 3650
				}
			}
		}
	}

	nys_first_steps = {
		icon = mission_alliances
		required_missions = {
			nys_staging_ground
		}
		trigger = {
			any_owned_province = {
				continent = europe
			}
		}
		effect = {
			add_country_modifier = {
				name = nys_colonial_fervor
				duration = 7300
			}
		}
	}

	nys_colonial_mastery = {
		icon = mission_alliances
		required_missions = {
			nys_first_steps
		}
		trigger = {
			calc_true_if = {
				any_known_country = {
					is_colonial_nation_of = NYS
				}
				amount = 3
			}
		}
		effect = {
			add_prestige = 15
			add_country_modifier = {
				name = nys_colonial_mastery
				duration = -1
			}
		}
	}

	nys_competitive_spirit = { # Gain claim on Halifax (for the harbor)
		icon = mission_alliances
		required_missions = {
			nys_colonial_mastery
		}
		trigger = {
			MRT = {
				OR = {
					NOT = {
						has_opinion = {
							who = NYS
							value = -100
						}
					}
					is_rival = NYS
				}
			}
			navy_size = MRT
		}
		effect = {
			4551 = {
				add_permanent_claim = NYS
			}
		}
	}

	nys_avarice = { # Own Halifax - gain trade steering buff + global trade power via "Ruthless merchants" modifier
		icon = mission_alliances
		required_missions = {
			nys_competitive_spirit
		}
		trigger = {
			4551 = {
				owned_by = NYS
				is_strongest_trade_power = NYS
			}
		}
		effect = {
			add_country_modifier = {
				name = nys_ruthless_merchants
				duration = 10950
			}
		}
	}
}

NewYork_Missions_5 = { # Culture and legislation
	slot = 5
	generic = no
	ai = yes
	potential = {
		tag = NYS
	}
	has_country_shield = yes

	nys_tax_overhaul = { # Numbers might need tweaking. Mostly placeholder
		position = 3
		icon = mission_alliances
		required_missions = {
			nys_city_reunited
		}
		trigger = {
			monthly_income = 8
			OR = {
				advisor = master_of_mint
				advisor = treasurer
			}
		}
		effect = {
			add_country_modifier = {
				name = nys_tax_reform
				duration = -1
			}
		}
	}
	nys_edict_of_multiculturalism = {
		icon = mission_alliances
		required_missions = {
			nys_tax_overhaul
		}
		trigger = {
			years_of_income = 0.5
			dip_power = 75
		}
		effect = {
			add_years_of_income = -0.5
			add_dip_power = -75
			add_country_modifier = {
				name = nys_multicultural_leanings
				duration = -1
			}
		}
	}
	nys_religious_freedom_act = {
		icon = mission_alliances
		required_missions = {
			nys_edict_of_multiculturalism
		}
		trigger = {
			stability = 2
			any_owned_province = {
				religion = jewish
			}
		}
		effect = {
			country_event = {
				id = ny_events.11
			}
		}
	}
	nys_common_understanding = { # Lowering intolerance and general unrest will foster goodwill towards protected minorities and 
		icon = mission_alliances # lead to a stronger contribution to the state from those groups. idea: policy does not always go hand-in-hand with the people
		required_missions = {
			nys_religious_freedom_act
		}
		trigger = {
			NOT = {
				AND = {
					unrest = 0.01
					any_owned_province = {
						nationalism = 0
					}
				}
			}
		}
		effect = {
			2639 = { # Raritan
				add_province_modifier = {
					name = nys_common_understanding_raritan
					duration = 3650
				}
			}
			add_country_modifier = {
				name = nys_common_understanding
				duration = 365
			}
			country_event = {
				id = ny_events.12
				days = 365
			}
		}
	}
}
nys_amos_tree = {
	slot = 4
	potential = {
		tag = NYS
		has_country_flag = nys_familial_missions
	}
	has_country_shield = yes

	nys_commitment_to_peace = {
		icon = mission_alliances
		position = 8
		required_missions = {
			nys_tammany_republic
		}
		trigger = {
			NOT = {
				AND = {
					has_disaster = ny_uprising_disaster
					is_at_war = yes
				}
			}
			stability = 3
		}
		effect = {
			add_adm_power = 75
			custom_tooltip = NY_UPRISING_PREVENTED_TOOLTIP
			hidden_effect = {
				if = {
					limit = {
						not = {
							has_country_flag = nys_uprising_crushed
						}
					}
					set_country_flag = nys_disaster_prevented
				}
			}
			
		}
	}
	### MORE MISSIONS HERE
	nys_confront_agitators = {
		icon = mission_alliances
		required_missions = {

		}
		trigger = {
			dynasty = "Levi"
			war_exhaustion = 2
		}
		effect = {
			country_event = {
				id = ny_events.15
			}
		}
	}
}