namespace = ny_events

# country_event = { # Election on ruler death
# 	id = ny_events.1
# 	title = ny_events.1.t
# 	desc = ny_events.1.desc
# 	picture = ELECTION_REPUBLICAN_eventPicture

# 	is_triggered_only = yes

# 	trigger = {
# 		always = yes
# 		has_reform = tammany_republic_reform
# 	}

# 	option = { # Wayne tree
# 		name = ny_events.1.a
# 		add_republican_tradition = -5
# 		define_ruler = {
# 			dynasty = "Wayne"
# 		}
# 	}
# 	option = { # Levi / Religious tree
# 		name = ny_events.1.b
# 		add_republican_tradition = -5
# 		define_ruler = {
# 			dynasty = "Levi"
# 		}
# 	}
# 	option = { # Colonial
# 		name = ny_events.1.c
# 		add_republican_tradition = -5
# 		define_ruler = {
# 			dynasty = "Amos"
# 		}
# 	}
# 	option = { # Trader
# 		name = ny_events.1.d
# 		add_republican_tradition = -5
# 		define_ruler = {
# 			dynasty = "Coeur"
# 		}
# 	}
# }

country_event = {
	id = ny_events.1
	title = ny_events.1.t
	desc = ny_events.1.desc
	picture = ELECTION_REPUBLICAN_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		always = yes
		has_reform = tammany_republic_reform
	}

	immediate = {
		hidden_effect = {
			if = {
				limit = {
					republic_with_female_rulers_trigger = yes
					NOT = { has_country_flag = ven_new_promissione_ducale }
				}
				define_exiled_ruler = {
					exiled_as = lottery_candidate_a_@ROOT
					random_gender = yes
					min_age = 50
					max_age = 75
					change_adm = -1
					change_dip = -1
					change_mil = 2
					option = 0
					dynasty = "Wayne"
				}
			}
			else_if = {
				limit = {
					republic_with_female_rulers_trigger = yes
					has_country_flag = ven_new_promissione_ducale
				}
				define_exiled_ruler = {
					exiled_as = lottery_candidate_a_@ROOT
					random_gender = yes
					min_age = 50
					max_age = 75
					change_adm = -1
					change_dip = -1
					change_mil = 3
					option = 0
					dynasty = "Wayne"
				}
			}
			else_if = {
				limit = {
					NOT = { republic_with_female_rulers_trigger = yes }
					has_country_flag = ven_new_promissione_ducale
				}
				define_exiled_ruler = {
					exiled_as = lottery_candidate_a_@ROOT
					min_age = 50
					max_age = 75
					change_adm = -1
					change_dip = -1
					change_mil = 3
					option = 0
					dynasty = "Wayne"
				}
			}
			else = {
				define_exiled_ruler = {
					exiled_as = lottery_candidate_a_@ROOT
					min_age = 50
					max_age = 75
					change_adm =-1
					change_dip = -1
					change_mil = 2
					option = 0
					dynasty = "Wayne"
				}
			}
			if = {
				limit = {
					republic_with_female_rulers_trigger = yes
					NOT = { has_country_flag = ven_new_promissione_ducale }
				}
				
				define_exiled_ruler = {
					exiled_as = lottery_candidate_b_@ROOT
					min_age = 50
					max_age = 75
					change_adm = 2
					change_dip = -1
					change_mil = -1
					random_gender = yes
					option = 1
					dynasty = "Levi"
				}
			}
			else_if = {
				limit = {
					republic_with_female_rulers_trigger = yes
					has_country_flag = ven_new_promissione_ducale
				}
				define_exiled_ruler = {
					exiled_as = lottery_candidate_b_@ROOT
					random_gender = yes
					min_age = 50
					max_age = 75
					change_adm = 3
					change_dip =-1
					change_mil = -1
					option = 0
					dynasty = "Levi"
				}
			}
			else_if = {
				limit = {
					NOT = { republic_with_female_rulers_trigger = yes }
					has_country_flag = ven_new_promissione_ducale
				}
				define_exiled_ruler = {
					exiled_as = lottery_candidate_b_@ROOT
					min_age = 50
					max_age = 75
					change_adm = 3
					change_dip = -1
					change_mil = -1
					option = 0
					dynasty = "Levi"
				}
			}
			else = {
				define_exiled_ruler = {
					exiled_as = lottery_candidate_b_@ROOT
					min_age = 50
					max_age = 75
					change_adm = 2
					change_dip = -1
					change_mil = -1
					option = 1
					dynasty = "Levi"
				}
			}
			if = {
				limit = {
					republic_with_female_rulers_trigger = yes
					NOT = { has_country_flag = ven_new_promissione_ducale }
				}
				
				define_exiled_ruler = {
					exiled_as = lottery_candidate_c_@ROOT
					min_age = 50
					max_age = 75
					change_adm = -1
					change_dip = 2
					change_mil = -1
					random_gender = yes
					option = 2
					dynasty = "Coeur"
				}
			}
			else_if = {
				limit = {
					republic_with_female_rulers_trigger = yes
					has_country_flag = ven_new_promissione_ducale
				}
				define_exiled_ruler = {
					exiled_as = lottery_candidate_c_@ROOT
					random_gender = yes
					min_age = 50
					max_age = 75
					change_adm = -1
					change_dip = 3
					change_mil = -1
					option = 0
					dynasty = "Coeur"
				}
			}
			else_if = {
				limit = {
					NOT = { republic_with_female_rulers_trigger = yes }
					has_country_flag = ven_new_promissione_ducale
				}
				define_exiled_ruler = {
					exiled_as = lottery_candidate_c_@ROOT
					min_age = 50
					max_age = 75
					change_adm = -1
					change_dip = 3
					change_mil = -1
					option = 0
					dynasty = "Coeur"
				}
			}
			else = {
				define_exiled_ruler = {
					exiled_as = lottery_candidate_c_@ROOT
					min_age = 50
					max_age = 75
					change_adm = -1
					change_dip = 2
					change_mil = -1
					option = 2
					dynasty = "Coeur"
				}
			}
			# if = {
			# 	limit = {
			# 		republic_with_female_rulers_trigger = yes
			# 		NOT = { has_country_flag = ven_new_promissione_ducale }
			# 	}
				define_exiled_ruler = { # For some reason, this option still spawns a ruler with the same age as that of house Coeur. Minor issue, but annoying.
					exiled_as = lottery_candidate_d_@ROOT
					min_age = 50
					max_age = 75
					random_gender = yes
					option = 2
					dynasty = "Amos"
				}
			# }
			# else_if = {
			# 	limit = {
			# 		republic_with_female_rulers_trigger = yes
			# 		has_country_flag = ven_new_promissione_ducale
			# 	}
			# 	define_exiled_ruler = {
			# 		exiled_as = lottery_candidate_d_@ROOT
			# 		random_gender = yes
			# 		min_age = 50
			# 		max_age = 75
			# 		option = 0
			# 		dynasty = "Coeur"
			# 	}
			# }
			# else_if = {
			# 	limit = {
			# 		NOT = { republic_with_female_rulers_trigger = yes }
			# 		has_country_flag = ven_new_promissione_ducale
			# 	}
			# 	define_exiled_ruler = {
			# 		exiled_as = lottery_candidate_d_@ROOT
			# 		min_age = 50
			# 		max_age = 75
			# 		option = 0
			# 		dynasty = "Coeur"
			# 	}
			# }
			# else = {
			# 	define_exiled_ruler = {
			# 		exiled_as = lottery_candidate_d_@ROOT
			# 		min_age = 50
			# 		max_age = 75
			# 		option = 2
			# 		dynasty = "Coeur"
			# 	}
			# }
		}
	}
	
	after = {
		clear_exiled_ruler = lottery_candidate_a_@ROOT
		clear_exiled_ruler = lottery_candidate_b_@ROOT
		clear_exiled_ruler = lottery_candidate_c_@ROOT
		clear_exiled_ruler = lottery_candidate_d_@ROOT
	}
	
	option = {
		name = ny_events.1.a
		ai_chance = {
			factor = 0
		}
		set_ruler = lottery_candidate_a_@ROOT
		add_republican_tradition = -25
		custom_tooltip = lottery_candidate_bonus_one
	}
	option = {
		name = ny_events.1.b
		ai_chance = {
			factor = 0
		}
		set_ruler = lottery_candidate_b_@ROOT
		add_republican_tradition = -25
		custom_tooltip = lottery_candidate_bonus_one
	}
	option = {
		name = ny_events.1.c
		ai_chance = {
			factor = 0
		}
		set_ruler = lottery_candidate_c_@ROOT
		add_republican_tradition = -25
		custom_tooltip = lottery_candidate_bonus_one
	}
	option = {
		name = ny_events.1.d
		ai_chance = {
			factor = 0
		}
		set_ruler = lottery_candidate_d_@ROOT
		add_republican_tradition = -25
		custom_tooltip = lottery_candidate_bonus_one
	}
	option = { # lottery
		name = ny_events.1.da
		ai_chance = {
			factor = 90
		}
		random_list = {
			25 = { 
				set_ruler = lottery_candidate_a_@ROOT 
			}
			25 = { 
				set_ruler = lottery_candidate_b_@ROOT 
			}
			25 = { 
				set_ruler = lottery_candidate_c_@ROOT 
			}
			25 = { 
				set_ruler = lottery_candidate_d_@ROOT 
			}
		}
		add_republican_tradition = 15
		custom_tooltip = lottery_candidate_bonus_plural
	}
	option = { # nepotism
		name = ny_events.1.e
		trigger = {
			has_government_attribute = enables_nepotism
		}
		ai_chance = { factor = 10 }
		if = {
			limit = {
				has_country_flag = strengthened_signoria_flag
			}
			custom_tooltip = strengthened_signoria_election_tt
			clr_country_flag = strengthened_signoria_flag
		}
		else = {
			add_republican_tradition = -15
		}
		if = {
			limit = { 
				republic_with_female_rulers_trigger = yes
				NOT = { has_reform = signoria_reform }
			}
			define_ruler = {
				min_age = 30
				max_age = 50
				change_mil = -1
				change_adm = -1
				change_dip = -1
				name = "lastname"
				random_gender = yes # Allows random gender for republics
			}
		}
		else_if = {
			limit = { 
				republic_with_female_rulers_trigger = yes
				has_reform = signoria_reform
			}
			define_ruler = {
				min_age = 30
				max_age = 50
				name = "lastname"
				random_gender = yes # Allows random gender for republics
			}
		}
		else_if = {
			limit = { 
				NOT = { republic_with_female_rulers_trigger = yes }
				has_reform = signoria_reform
			}
			define_ruler = {
				min_age = 30
				max_age = 50
				name = "lastname"
			}
		}
		else = {
			define_ruler = {
				min_age = 30
				max_age = 50
				change_mil = -1
				change_adm = -1
				change_dip = -1
				name = "lastname"
			}
		}
		if = {
			limit = { 
				has_faction = mr_aristocrats 
			}
			add_faction_influence = {
				faction = mr_aristocrats
				influence = 10
			}				
		}
	}
}

country_event = { # Dictatorship
	id = ny_events.2
	title = ny_events.2.t
	desc = ny_events.2.desc
	picture = ELECTION_REPUBLICAN_eventPicture
	fire_only_once = yes

	trigger = {
		tag = NYS
		NOT = {
			republican_tradition = 40
		}
		NOT = {
			has_country_flag = nys_tammany_abolished
		}
	}

	option = {
		name = ny_events.2.a
		add_government_reform = vicar_of_lady_liberty_reform
		set_country_flag = nys_tammany_abolished
	}
}

country_event = { # War on Hudsonia
	id = ny_events.3
	title = ny_events.3.t
	desc = ny_events.3.desc
	picture = WAR_OF_THE_ROSES_eventPicture

	is_triggered_only = yes

	trigger = {
		tag = NYS
	}

	option = {
		name = ny_events.3.a
		declare_war_with_cb = {
			casus_belli = cb_annex
			who = HUD
			war_goal_province = 4583
		}
		RED = {
			join_all_offensive_wars_of = NYS
		}
	}
}

country_event = { # Fate of the Hudsonian heathens
	id = ny_events.4
	title = ny_events.4.t
	desc = ny_events.4.desc
	picture = RELIGION_eventPicture

	is_triggered_only = yes

	trigger = {
		tag = NYS
	}

	option = { # Tolerance
		name = ny_events.4.a
		add_country_modifier = {
			name = nys_chose_tolerance
			duration = 7305
		}
	}
	option = { # Perish
		name = ny_events.4.b
		add_country_modifier = {
			name = nys_chose_intolerance
			duration = 7305
		}
		hudson_valley_area = {
			add_unrest = 10
		}
	}
}

country_event = { # The Empire State
	id = ny_events.5
	title = ny_events.5.t
	desc = ny_events.5.desc
	picture = RELIGION_eventPicture

	is_triggered_only = yes

	trigger = {
		tag = NYS
	}

	option = { # Keep Tammany, change name to The Empire State
		name = ny_events.5.a
		override_country_name = EMPIRE_STATE
	}

	option = { # Take control, change name...
		name = ny_events.5.b
		add_government_reform = vicar_of_lady_liberty_reform
		override_country_name = EMPIRE_STATE
	}

	option = { # BORING!
		name = ny_events.5.c
		trigger = {
			OR = {
				ruler_has_personality = craven_personality
				ruler_has_personality = babbling_buffoon_personality
				ruler_has_personality = naive_personality
			}
		}
		add_prestige = -5
	}
}

country_event = { # The Tammany Republic (Mission)
	id = ny_events.6
	title = ny_events.6.t
	desc = ny_events.6.desc
	picture = RELIGION_eventPicture

	is_triggered_only = yes

	trigger = {
		tag = NYS
	}

	option = { # Keep Tammany and strengthen the republic
		name = ny_events.6.a
		custom_tooltip = nys_stay_tammany
		add_country_modifier = {
			name = nys_faith_in_tammany
			duration = 18250
		}
		add_country_modifier = {
			name = ny_family_business
			duration = -1
		}
		custom_tooltip = nys_missions_unlocked
		set_country_flag = nys_familial_missions
		hidden_effect = {
			swap_non_generic_missions = yes
		}
	}

	option = { # Murmurs of dissent
		name = ny_events.6.b
		custom_tooltip = nys_leave_tammany
		add_country_modifier = {
			name = nys_murmurs_of_dissent
			duration = 18250
		}
		add_country_modifier = {
			name = ny_family_business
			duration = -1
		}
		custom_tooltip = nys_missions_unlocked
		set_country_flag = nys_familial_missions
		hidden_effect = {
			swap_non_generic_missions = yes
		}
	}
}

# NONE OF THIS WORKS. IDK WHY. IT'S LATE AND IM DONE WITH IT.

country_event = { # Closening our bond mission event (for Philadelphia)
	id = ny_events.7
	title = ny_events.7.t
	desc = ny_events.7.desc
	picture = RELIGION_eventPicture

	is_triggered_only = yes

	option = { # Accept
		name = ny_events.7.a
		add_treasury = 150
		NYS = {
			create_subject = {
				subject_type = vassal
				subject = ROOT
			}
		}
		ai_chance = {
			factor = 9
			modifier = {
				factor = 0
				total_development = NYS			
			}
		}
	}

	option = { # Politely decline
		name = ny_events.7.b
		NYS = {
			add_opinion = {
				who = THIS
				modifier = nys_phi_spurned_protection
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 3
				any_owned_province = {
					NOT = { 
						province_id = 956
					}
				}
			}
			modifier = {
				factor = 3
				total_development = 50
			}
		}
	}

	after = {
		NYS = {
			country_event = {
				id = ny_events.8
				days = 5
			}
		}
	}
}

country_event = { # Philadelphia's response
	id = ny_events.8
	title = ny_events.8.t
	picture = RELIGION_eventPicture
	is_triggered_only = yes
	desc = { # Philadelphia accepted
		trigger = {
			PLD = {
				vassal_of = NYS
			}
		}
		desc = ny_events.8.desc.a
	}
	desc = { # They reject me :-(
		trigger = {
			NOT = {
				PLD = {
					vassal_of = NYS
				}
			}
		}
		desc = ny_events.8.desc.b
	}

	option = { # Great!
		name = ny_events.8.a
		trigger = {
			PLD = {
				vassal_of = NYS
			}
		}
		add_prestige = 10
		# Add relations hit with rest of trade league
		every_known_country = {
			if = {
				limit = { 
					is_in_trade_league_with = NYS
				}
				add_opinion = {
					who = NYS
					modifier = nys_intimidated_league_member
				}
			}
		}
	}

	option = { # Prepare for war
		name = ny_events.8.b
		trigger = {
			NOT = {
				PLD = {
					vassal_of = NYS
				}
			}
		}
		add_treasury = 150
		956 = {
			add_permanent_claim = NYS
		}
	}
}

country_event = {
	id = ny_events.9
	title = ny_events.9.t
	desc = ny_events.9.d
	picture = DEBATE_REPUBLICAN_eventPicture
	is_triggered_only = yes

	option = {
		name = ny_events.9.a
		add_government_reform = four_families_reform
		change_government_reform_progress = -100
	}
}

country_event = {
	id = ny_events.10
	title = ny_events.10.t
	desc = ny_events.10.d
	picture = DEBATE_REPUBLICAN_eventPicture
	is_triggered_only = yes

	option = { # Publish our findings! Gain prestige + diplo, but strong relations penalty with any other colonial powers
		name = ny_events.10.a
		add_prestige = 25
		add_dip_power = 75
		every_known_country = {
			if = {
				limit = { 
					OR = {
						europe = {
							has_discovered = PREV
						}
						africa = {
							has_discovered = PREV
						}
					}
				}
				add_opinion = {
					who = NYS
					modifier = nys_published_colonial_discovery
				}
			}
		}
	}

	option = { # Keep it a secret...
		name = ny_events.10.b
		add_prestige = -5
		every_known_country = {
			if = {
				limit = { 
					OR = {
						europe = {
							has_discovered = PREV
						}
						africa = {
							has_discovered = PREV
						}
					}
				}
				add_opinion = {
					who = NYS
					modifier = nys_protected_colonial_discovery
				}
			}
		}
	}
}

country_event = {
	id = ny_events.11
	title = ny_events.11.t
	desc = ny_events.11.d
	picture = DEBATE_REPUBLICAN_eventPicture
	is_triggered_only = yes

	option = {
		name = ny_events.11.a
		define_advisor = {
			type = treasurer
			skill = 2
			name = "Isiah Spiro"
			cost_multiplier = 0.5
			religion = jewish
		}
	}

	option = {
		name = ny_events.11.b
		define_advisor = {
			type = trader
			skill = 2
			name = "Janie Levitt"
			female = yes
			cost_multiplier = 0.5
			religion = jewish
		}
	}

	option = {
		name = ny_events.11.c
		define_advisor = {
			type = recruitmaster
			skill = 2
			name = "Sakeri Pirbright"
			cost_multiplier = 0.5
			religion = jewish
		}
	}
}

country_event = { # Religious Tolerance was only being applied very loosely and on an ad-hoc basis. Many minorities are finding themselves more at odds with the 
	id = ny_events.12 # local population than ever before due to rising fears of cultural replacement
	title = ny_events.12.t
	desc = ny_events.12.d
	picture = DEBATE_REPUBLICAN_eventPicture
	is_triggered_only = yes

	option = { # Listen to these concerns. We will overhaul the system (unpopular with primary culture, popular with minorities. -missionary strength / conversion cost?)
		name = ny_events.12.a # Liberty is for everyone.
		add_country_modifier = {
			name = nys_liberty_reforms
			duration = -1
		}
		every_owned_province = {
			if = {
				limit = { 
					AND = {
						religion = americanist
						has_owner_culture = yes
					}
				}
				add_province_modifier = {
					name = nys_critics_of_liberty
					duration = 10950
				}
			}
		}
	}

	option = { # We have done more than enough for them! Get out of my sight!
		name = ny_events.12.b # START TICKING DISASTER? - when fires, give Raritan huge unrest but strong local missionary strength. when the disaster is solved, grant
		# missionary strength vs heretics and culture conversion cost reduction
		2639 = {
			hidden_effect = {
				remove_province_triggered_modifier = legacy_of_levi
			}
			custom_tooltip = NYS_LEGACY_LEVI_REMOVED
			add_province_modifier = {
				name = nys_storm_brewing
				duration = -1
			}
			custom_tooltip = NYS_MINORITY_DISASTER_WARNING
		}
		set_country_flag = nys_uprising_ticking
	}
}

country_event = { # Uprising disaster start
	id = ny_events.13
	title = ny_events.13.t
	desc = ny_events.13.d
	picture = DEBATE_REPUBLICAN_eventPicture
	is_triggered_only = yes

	option = {
		name = ny_events.13.a # Oh no!
		add_stability = -3
		every_owned_province = {
			if = {
				limit = { 
					OR = {
						has_owner_religion = no
						has_owner_culture = no
					}
				}
				add_province_modifier = {
					name = nys_uprising_minority_unrest
					duration = -1
				}
				leadered_peasant_rebels = 20
			}
		}
	}
}

country_event = { # Uprising disaster end
	id = ny_events.14
	title = ny_events.14.t
	desc = ny_events.14.d
	picture = DEBATE_REPUBLICAN_eventPicture
	is_triggered_only = yes

	option = {
		name = ny_events.14.a # Finally!
		every_owned_province = {
			if = {
				limit = { 
					has_province_modifier = nys_uprising_minority_unrest
				}
				remove_province_modifier = nys_uprising_minority_unrest
			}
		}
		set_country_flag = nys_uprising_crushed
	}
}